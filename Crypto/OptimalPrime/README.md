# UMCTF2021 - OptimalPrime

- Write-Up Author: Bon \[[MOCTF](https://www.facebook.com/MOCSCTF)\]

- Flag:flag is mocsctf{50met1me_1e55_15_m0re!!!!!}

## **Question:**
OptimalPrime

>Why RSA use two prime numbers only? I want more!

[chall](./chall)

## Write up
**below tool required in this article.**  
[RSA algorithm](https://simple.wikipedia.org/wiki/RSA_algorithm)  
[yafu](https://github.com/DarkenCode/yafu) - YAFU (with assistance from other free software) uses the most powerful modern
algorithms (and implementations of them) to factor input integers in a 
completely automated way. 

---

It is rsa encryption with multiple prime..
Use yafu to retrieved 100 prime numbers.

and follow the RSA algorithm to get the flag
```python
p=[948189883, 806371127, 983627419, 922370873, 710133841, 970803397, 948131297, 881992637, 555569041, 570889073, 1019591593, 894703477, 942624797, 855695303, 813154561, 773397017, 912599657, 884213833, 708103777, 627347051, 919016663, 620925619, 609854051, 960133253, 798162641, 762443249, 875664247, 887037601, 1063662961, 788564869, 816657089, 595964497, 992394059, 844055741, 605993767, 1046768507, 976336303, 775778513, 731039297, 1041778523, 590302481, 915074821, 634617733, 660852937, 882704551, 963612317, 914695651, 714113677, 873125777, 605891359, 746869439, 553444777, 821662799, 993827501, 1014994511, 944163791, 664898489, 1066335797, 780649439, 935618921, 538161389, 680041933, 738323461, 979956583, 1011177553, 974213743, 1022835799, 1000086119, 995992163, 903215623, 1052208397, 1038053953, 782563643, 612454543, 811422847, 684428417, 569271767, 652285547, 809878837, 572363761, 1044383909, 1038709811, 869123989, 886364519, 576089711, 965938769, 852725177, 887827939, 693091541, 915018667, 615665321, 551123563, 812413313, 952578197, 1073693263, 858885817, 820892417, 780881861, 627925421, 1059762463]

n=1
phi=1

for i in p:
  n=n*i
  phi=phi*(i-1)


def find_inverse(x,y):
  inv = eea(x,y)[0]
  if inv < 1: inv += y 
  return inv

def eea(a,b):
  if b==0:return (1,0)
  (q,r) = (a//b,a%b)
  (s,t) = eea(b,r)
  return (t, s-(q*t) )

d=find_inverse(e,phi)

c=1107260509327791915526864183284102283261063124733124807343271714076064809131582764000712703291357824758847509142915788804060208225242771071371170177631275346335094860077542854418962257615629256793764125617905240890272075600010260820279472723674885305292078014110222015097920482941353438775804670765092673055074181116867847080515400808368278664853482042134790644574397431633600290100221715095077473526809917601033811939212996766554812809156851465608064191113928116452997880665481119358985667540325372285047766348991204141004191163920800330148500559847194097411293085125261576741293431915291171767443192620665528059906015675059577204468201305673870000516774854434319813005609363294273706481252830974942464203614000746450725484320125952393981820742881124181886577158854731844161572168094163960820803921014138851478930708107832407705763921431873684732734960456921595238270909201141895975743016922

print(bytearray.fromhex(hex(pow(c,d,n)).rstrip("L")[2:]).decode())

```